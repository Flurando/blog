Title: 如何把硬盘上空闲的空间分配给lvm扩容
Date: 2024-12-23
Category: 技术
Tags: 简单,命令行

### 适用

本教程只适用于以下人群

1. 使用linux电脑，由lv（logical volumn逻辑容量）管理而不是直接pv（physical volumn物理容量）。具体实验可以运行`sudo lvdisplay`查看，或者root用户直接`lvdisplay`，有输出列着各种lv就说明你符合。
2. 硬盘上真的有剩余空间。这里不要求是一块硬盘，因为lv的特色就是可以把任意多块不连续的当一块用。具体可以运行`sudo vgdisplay`或`sudo vgs`查看，root用户的话不用打`sudo`直接命令回车就好。

### 操作

首先打开终端，tty也行。不大清楚的在自己软件里搜terminal或者终端，把那个软件打开就行。我就当你用的图形界面，不然不可能不清楚。如果根本就没有terminal或终端，建议检查自己用的是不是linux。

然后`sudo lvdisplay`，看看你要扩容的是哪个逻辑分区，一般最后是root的就是你的root，home就是home，swap什么的就是交换分区（交换分区可以当虚拟内存，也可以用来保存桌面之类的，不够用可以扩）。记住，记下那个Path路径，等下就靠这个告诉扩容命令扩的是哪个。

接下来`sudo lvextend -L +1G -r <你想扩容的那个分区在上一个命令对应的Path路径>`就可以了，这里可别把“<>”输进去啊（当然输了也没事，扩容不存在的逻辑分区会报错）。这条命令里，`sudo`是用root身份运行后面命令，`lvextend`是logical volumn extend逻辑容量扩展的意思，这命令就干这个。接下来的`-L +1G`表示我们要扩容1G，当然你也可以写+2G或者+100M之类的，具体看文档————值得注意的是，这里也可以用-l代替，但用了-l就是用百分比算了，具体看文档，`sudo lvextend --longhelp`就行。如果你不清楚到底硬盘有多少空余也懒得看使用方法，在这一步之前建议输入`sudo vgdisplay`或者`sudo vgs`，它会输出你目前整个逻辑硬盘的大小和物理硬盘剩余的大小，然后按我的命令输，只改+1G那块。最后那个-r表示扩容后resize改变大小，改变的什么大小呢？文件系统。不用-r的结果是你本来20G的root分区是在一块20G的逻辑盘上，扩容后这个逻辑盘变成了21G，但你的root分区还是20G，虽然可以之后手动扩，但是我认为那恐怕不是大多数用户想要的效果。

如果没有输出错误，那么大功告成！

### 总结

其实需要的命令就几步

```bash
sudo -i
vgs
lvdisplay
lvextend -L +1G -r <PATH-IN-LVDISPLAY>
exit
```

我这里是因为都要`sudo`干脆直接`sudo -i`换成root用户得了，最后`exit`退出root用户千万别忘，root用户下不当操作或者运行破坏性程序是非常危险的！